---
layout: post
title: RAG 1 - 문서에서 정보를 찾아 응답을 해주는 챗봇을 만들어보자
author: 사유담
excerpt_image: ./assets/images/post_images/document-retrieval-chatbot/thumbnail-001.webp
categories: 프로그래밍
tags: 챗봇 임베딩 RAG
top: 2
---

![banner](/assets/images/post_images/document-retrieval-chatbot/thumbnail-001.webp)
*이 이미지는 ChatGPT를 사용하여 만들었습니다.*

## RAG 1 - 문서에서 정보를 찾아 응답을 해주는 챗봇을 만들어보자

개인 프로젝트 중 하나로 지역 명소 정보를 알려주는 IOS 어플리케이션 개발을 진행한 적이 있었다. 당시 몇몇 분들이 인공지능을 함께 접목해보는 것은 어떤지 아이디어를 주었는데, 당시에는 IOS를 배우느라 거기까지 신경을 쓸 겨를이 없었다. 그렇게 다른 개인 프로젝트를 진행하다가 시간이 비는 어느 날 문뜩, 만들어볼까 하는 생각이 들었다. 복잡하게 생각하지 말고 문서를 정리하여 어딘가 저장해둔 다음, 키워드를 바탕으로 사용자의 대화 혹은 질문과 가장 유사한 항목을 찾은 다음, 이 문서를 프롬프트에 던져주어 답변하게 하면 되는거 아닌가?

### 1. 구성
이 아이디어를 구현하기 위해 필요한 것들은 아래와 같다.

1. 대규모 언어모델
2. 유사도 측정 언어모델
3. 챗봇 코드

### 2. 동작 과정
사용자가 질문하고 답변을 받기까지의 일련의 과정은 아래와 같다.

1. 사용자가 질문을 한다.
2. 키워드 DB에서 사용자의 질문과 가장 유사한 항목을 찾는다.
3. 해당되는 문서를 사용하여 프롬프트를 생성한다.  
    (만약 유사도가 특정 임계값을 넘지 못하면 다른 프롬프트를 생성한다.)
4. 프롬프트와 사용자의 질문을 바탕으로 인공지능 챗봇 모델에게 질문한다.
5. 챗봇의 답변을 사용자에게 전달한다.

### 3. 구현
프로젝트의 구성 요소들은 아래와 같이 구현한다.

1. 대규모 언어모델: NVIDIA NIM에서 서비스하는 모델을 활용
2. 유사도 측정 언어모델: SBERT를 사용하여 로컬 네트워크 PC에 구현
3. 챗봇 코드: 코드 작성 후 맥스튜디오에서 테스트

3번 챗봇 코드의 경우 2번 유사도 측정 언어모델과 다른 위치에서 동작시킬 것이다. 이렇게 분리를 함으로서 실제 클라이언트가 SBERT 모델이 동작하고 있는 서버에 요청을 보내고 받는 구조를 모사하도록 할 것이다. 이를 그림으로 표현하면 아래와 같다.


![프로젝트 구성](/assets/images/post_images/document-retrieval-chatbot/project-config-001.png)


**다음 이야기**: 문장 임베딩 API 만들기